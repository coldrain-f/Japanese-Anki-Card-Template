# Anki 카드 템플릿 설계

## 개요

일본어 학습을 위한 Anki 카드 템플릿 3종 설계

---

## 1. 단어 카드 템플릿

### 카드 타입

**타입1 (한→일)**
- 앞면: 한국어 뜻 + Exclude1
- 뒷면: 일본어 단어
- 생성 조건: GenerateKR2JP 필드에 값 있을 때

**타입2 (일→한)**
- 앞면: 일본어 단어 + Exclude2
- 뒷면: 한국어 뜻
- 생성 조건: GenerateJP2KR 필드에 값 있을 때

### 필드 구성

**필수 필드:**
- `Frequency`: JPDB 빈도 순위 (예: 156)
- `Expression`: 일본어 단어 (예: 思う)
- `Reading`: 후리가나 표기 (예: 思[お]もう)
- `Meaning`: 한국어 뜻 (예: 생각하다)

**선택 필드:**
- `Exclude1`: 한→일 앞면에 표시할 제외 항목. `|`로 구분 (예: 考える|思いつく|思い出す)
- `Exclude2`: 일→한 앞면에 표시할 제외 항목. `|`로 구분 (예: 생각나다|떠올리다)
- `GenerateKR2JP`: 값 있으면 한→일 카드 생성 (예: Y)
- `GenerateJP2KR`: 값 있으면 일→한 카드 생성 (예: Y)
- `MeaningCount`: 뜻 개수 표시 (예: 2) - 2개 이상일 때만 입력
- `Image`: 헷갈리는 한자용 이미지

### 카드 생성 제어

**기본 동작:**
- GenerateJP2KR만 Y → 일→한 카드만 생성 (읽기용)
- 둘 다 Y → 양방향 카드 생성 (회화용)
- 나중에 필드에 Y 채워넣으면 그때 카드 자동 생성됨

**사용 예시:**

```
읽기만 필요한 단어:
  GenerateJP2KR = Y
  GenerateKR2JP = (비어있음)

회화에도 필요한 단어:
  GenerateJP2KR = Y
  GenerateKR2JP = Y
```

### Exclude 필드 설명

**목적:** 유사 단어 혼동 방지

**Exclude1 (한→일 카드용):**
- 앞면에 한국어 뜻이 나올 때
- 일본어 유사어를 "이건 아니야"라고 힌트로 표시

```
앞면: 생각하다
      (除外: 考える, 思い出す, 思いつく)
뒷면: 思う
```

**Exclude2 (일→한 카드용):**
- 앞면에 일본어가 나올 때
- 한국어 유사어를 표시 (일본어 표시하면 뜻 유추됨)

```
앞면: 思う
      (除外: 생각나다, 떠올리다)
뒷면: 생각하다
```

**구분자:** `|` (파이프) 사용

```
考える|思い出す|思いつく
```

### 카드 예시

**타입1 (한→일):**

```
┌─────────────────────────┐
│ 앞면                     │
│                         │
│ 생각하다                 │
│                         │
│ 除外: 考える, 思い出す,   │
│      思いつく            │
└─────────────────────────┘
         ↓
┌─────────────────────────┐
│ 뒷면                     │
│                         │
│ 思う (おもう)            │
└─────────────────────────┘
```

**타입2 (일→한):**

```
┌─────────────────────────┐
│ 앞면                     │
│                         │
│ 思う                     │
│                         │
│ 除外: 생각나다, 떠올리다  │
└─────────────────────────┘
         ↓
┌─────────────────────────┐
│ 뒷면                     │
│                         │
│ 생각하다                 │
└─────────────────────────┘
```

---

## 2. 그룹 카드 템플릿

### 용도

비슷하게 생겨서 헷갈리는 단어 그룹 학습

### 카드 타입

**타입1 (일→한)**
- 앞면: 그룹 일본어 단어 (랜덤 순서)
- 뒷면: 그룹 한국어 뜻 (동일 순서)

### 필드 구성

**필수 필드:**
- `Items`: `|`로 구분된 단어 목록

**Items 형식:**
```
霜(しも)서리|霧(きり)안개|雪(ゆき)눈|雲(くも)구름|曇(くもり)흐림
```

### 랜덤 표시 기능

**문제:** 순서 고정되면 순서만 외워버림

**해결:** 매번 랜덤 순서로 표시

```
1회차: 雪 霧 曇 雲 霜
2회차: 霜 雲 雪 曇 霧
3회차: 霧 曇 霜 雪 雲
```

**구현:**

```javascript
// 앞면: seed 생성 후 저장
const seed = Date.now();
sessionStorage.setItem('groupSeed', seed);
const items = '{{Items}}'.split('|');
const shuffled = shuffleWithSeed(items, seed);
displayFront(shuffled);

// 뒷면: 같은 seed로 동일 순서 유지
const seed = sessionStorage.getItem('groupSeed');
const items = '{{Items}}'.split('|');
const shuffled = shuffleWithSeed(items, seed);
displayBack(shuffled);
```

### 카드 예시

**앞면 (랜덤 순서):**

```
┌─────────────────────────┐
│ 앞면                     │
│                         │
│ 雪   霧   曇   雲   霜   │
│ ?    ?    ?    ?    ?   │
└─────────────────────────┘
```

**뒷면 (동일 순서):**

```
┌─────────────────────────┐
│ 뒷면                     │
│                         │
│ 雪   霧   曇   雲   霜   │
│ ゆき きり くもり くも しも │
│ 눈  안개  흐림  구름 서리 │
└─────────────────────────┘
```

### 그룹 카드 활용 예시

- **weather**: 曇霜雲雪霧 (雨 부수)
- **look**: 見観視覧眺 (보다 관련)
- **speak**: 話語言説談 (말하다 관련)

---

## 3. 문장 카드 템플릿

### 용도

- 문법 학습
- 단어 용법 학습
- 유사 표현 구분

### 카드 타입

**타입1 (한→일)**
- 앞면: 한국어 문장 + Exclude1
- 뒷면: 일본어 문장
- 생성 조건: GenerateKR2JP 필드에 값 있을 때

**타입2 (일→한)**
- 앞면: 일본어 문장 + Exclude2
- 뒷면: 한국어 문장
- 생성 조건: GenerateJP2KR 필드에 값 있을 때

### 필드 구성

**필수 필드:**
- `SentenceJP`: 일본어 문장 (예: 私は学生だ。)
- `SentenceKR`: 한국어 문장 (예: 나는 학생이다.)

**선택 필드:**
- `Grammar`: 관련 문법 (예: 〜は〜だ)
- `Exclude1`: 한→일 앞면에 표시할 제외 항목. `|`로 구분 (예: 俺|僕)
- `Exclude2`: 일→한 앞면에 표시할 제외 항목. `|`로 구분 (예: 저|본인)
- `GenerateKR2JP`: 값 있으면 한→일 카드 생성 (예: Y)
- `GenerateJP2KR`: 값 있으면 일→한 카드 생성 (예: Y)

### Exclude가 필요한 경우

- **인칭대명사**: 私/俺/僕/わたくし/あたし → 다른 인칭 표현
- **존경/겸양**: 言う/おっしゃる/申す → 다른 경어 표현
- **유사 문법**: ながら/つつ → 비슷한 문법
- **구어/문어**: だ/です/である → 다른 문체
- **한자/가나**: 出来る/できる → 다른 표기

### 카드 예시

**타입1 (한→일):**

```
┌─────────────────────────────┐
│ 앞면                         │
│                             │
│ 나는 학생이다.               │
│                             │
│ 除外: 俺, 僕                 │
└─────────────────────────────┘
         ↓
┌─────────────────────────────┐
│ 뒷면                         │
│                             │
│ 私は学生だ。                 │
└─────────────────────────────┘
```

**타입2 (일→한):**

```
┌─────────────────────────────┐
│ 앞면                         │
│                             │
│ 私は学生だ。                 │
│                             │
│ 除外: 저, 본인               │
└─────────────────────────────┘
         ↓
┌─────────────────────────────┐
│ 뒷면                         │
│                             │
│ 나는 학생이다.               │
└─────────────────────────────┘
```

---

## 4. 전체 구조 요약

### 템플릿 비교

**단어 카드**
- 카드 수: 선택적 1~2장
- 용도: 어휘 암기
- 특징: Generate 필드로 제어

**그룹 카드**
- 카드 수: 1장/그룹
- 용도: 헷갈리는 단어 그룹
- 특징: 랜덤 순서

**문장 카드**
- 카드 수: 선택적 1~2장
- 용도: 문법, 용법
- 특징: Generate 필드로 제어

### 공통 규칙

- **Exclude 구분자**: `|` (파이프)
- **카드 생성 제어**: GenerateKR2JP, GenerateJP2KR 필드
- **기본값**: 필드 비어있으면 카드 생성 안 함
- **나중 추가**: 필드에 Y 넣으면 카드 자동 생성

### 필드 총정리

**단어 카드:**
```
Frequency, Expression, Reading, Meaning, MeaningCount,
Exclude1, Exclude2, GenerateKR2JP, GenerateJP2KR, Image
```

**그룹 카드:**
```
Items
```

**문장 카드:**
```
SentenceJP, SentenceKR, Grammar, 
Exclude1, Exclude2, GenerateKR2JP, GenerateJP2KR
```

---

## 5. 사용 시나리오

### 기본 학습 흐름

```
1. 단어 카드 (일→한만)로 어휘 암기 시작
   - GenerateJP2KR = Y
   - GenerateKR2JP = (비어있음)

2. 회화 필요한 단어 발견
   - GenerateKR2JP = Y 추가
   - 한→일 카드 자동 생성

3. 유사어 혼동 발생
   - Exclude1, Exclude2 추가

4. 헷갈리는 한자 발견
   - 그룹 카드 생성

5. 용법/문법 필요
   - 문장 카드 생성
```

### Exclude 입력 시점

**처음부터 입력 ❌**
```
16,000개 전부 Exclude 채우기 = 불가능
```

**필요할 때 입력 ✅**
```
1. 카드 리뷰 중 틀림
2. "아 이거 考える랑 헷갈렸네"
3. 해당 카드에 Exclude 추가
4. 다음부터 힌트로 활용
```

---

## 6. 구현 TODO

### 디자인 & 스타일
- [x] 디자인 계획 문서 작성 (`docs/DESIGN_PLAN.md`)
- [x] 폰트 선택: 유민(일본어) + Noto Serif KR(한국어)
- [x] 폰트 파일 준비 (`fonts/` 폴더)
- [x] 기본 CSS 작성 (`src/card.css`)
- [x] 레이아웃 설계 (왼쪽 정렬, 사전 스타일)
- [x] 다크 모드 스타일 (nightMode, night_mode)
- [x] 플랫폼별 스타일 (iOS Safe Area, 모바일 폰트 조정)

### 단어 카드
- [ ] 노트 타입 생성 (Anki에서 직접)
- [x] 템플릿 (앞/뒤) 작성 (`src/word/`)
  - `kr2jp-front.html`, `kr2jp-back.html`
  - `jp2kr-front.html`, `jp2kr-back.html`
- [ ] Generate 조건 설정 (Anki에서 직접)

### 그룹 카드
- [ ] 노트 타입 생성
- [ ] 랜덤 스크립트 작성

### 문장 카드
- [ ] 노트 타입 생성
- [ ] 템플릿 (앞/뒤) 작성
- [ ] Generate 조건 설정

### 기타
- [ ] JPDB Frequency 추가 애드온 개발
